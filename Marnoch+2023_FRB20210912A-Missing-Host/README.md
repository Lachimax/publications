The scripts found in this directory are for reproducing results in Marnoch et al 2023.

 The paper can be found at:
 - arXiv: https://arxiv.org/abs/2307.14702

### Scripts

#### `00_misc_values.py`

Derives some miscellaneous values quoted in the paper.


#### `01_association.py`

Runs PATH (Probabilistic Association of Transients; Aggarwal et al 2021) in various configurations on the imaging data 
covering FRB 20210912A.


#### `02_association_analysis.py`

Derives results related to the PATH (Probabilistic Association of Transients; Aggarwal et al 2021) runs. 
Generates Figure 2.
Must be run AFTER `01_association.py`.


#### `03_imaging_limits.py`

Derives the imaging limits.


#### `04_redshift_hosts.py`

Generates the synthetic magnitudes for our FRB hosts at a range of redshifts.
Uses Prospector SED models generated by Gordon et al 2023.


#### `05_redshift_plots.py`

Generates Figures 3+.
`04_redshift_hosts.py` must be run first.


#### `06_foreground_halos.py`

Uses GAMA DR4 and mNFW profiles to estimate a partial foreground halo contribution to the DM of FRB 
20210912A.


#### `07_scattering.py`

Uses the framework of Cordes et al 2022 to estimate the host dispersion
measure contribution from the scattering timescale.


#### `08_bright_stars.py`

Finds the nuisance stars in Gaia and makes some check plots.


#### `09_frbstats.py`

Uses the FRBSTATS catalogue of FRBs (https://www.herta-experiment.org/frbstats/) to enumerate those that have DM 
consistent with z>1.


### Prerequisites
 - `astropy`: tested with version `5.2.1`
 - `craft-optical-followup`(https://github.com/Lachimax/craft-optical-followup); tested with:
   - Branch: `marnoch+2023` (latest commit)
 - `frb`(https://github.com/FRBs/FRB); tested with:
   - Branch: `main` (latest commit)
 - `matplotlib`: tested with version `3.7.1`
 - `numpy`: tested with version `1.22.3`

### Data

To inquire after other data used by these scripts, please contact me directly.
#### `cordes+2022`
Contains the data from Table 3 from Cordes et al 2022, in the ecsv format.
#### `james.c.w-p-z-dm`
Contains, as a set of numpy .npy files, the p(z|DM) distribution used in this work. Generated by Clancy James using the `zDM` code (https://github.com/FRBs/zdm; James et al 2021).

### References
 - Aggarwal, K. et al 2021: *Probabilistic Association of Transients to their Hosts (PATH)*, ApJ 95:911:2 [https://doi.org/10.3847/1538-4357/abe8d2]
 - Cordes, J. et al 2022: *Redshift Estimation and Constraints on Intergalactic and Interstellar Media from Dispersion and Scattering of Fast Radio Bursts*, ApJ 931:2:88 [https://doi.org/10.3847/1538-4357/AC6873]
 - Gordon, A. C. et al 2023: *The Demographics, Stellar Populations, and Star Formation Histories of Fast Radio Burst Host Galaxies: Implications for the Progenitors* [https://arxiv.org/abs/2302.05465]
 - James, C. W. et al 2021: *The zâ€“DM distribution of fast radio bursts*, MNRAS 509:4:4775--4802
 - Marnoch, L. et al 2023: The unseen host galaxy and high dispersion measure of a precisely-localised Fast Radio Burst suggests a high-redshift origin [https://arxiv.org/abs/2307.14702]
