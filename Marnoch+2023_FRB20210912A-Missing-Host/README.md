The scripts found in this directory are for reproducing results in Marnoch et al 2023.

 The paper can be found at:
 - DOI: https://doi.org/10.1093/mnras/stad2353
 - arXiv: https://arxiv.org/abs/2307.14702

### Prerequisites
 - `astropy`: tested with version `5.2.1`
 - `craft-optical-followup`(https://github.com/Lachimax/craft-optical-followup); tested with:
   - Release: `v0.3.1-marnoch+2023`
 - `frb`(https://github.com/FRBs/FRB); tested with:
   - Release: `v2.1`
 - `matplotlib`: tested with version `3.7.1`
 - `numpy`: tested with version `1.22.3`
 - `photutils`: tested with version `1.2.0`

### Data

All necessary data is included or will be downloaded by [00-download](00-download.py)
#### `cordes+2022`
Contains the data from Table 3 from Cordes et al 2022, in the ecsv format.
#### `gordon.a.c-prospector-models`
Contains FRB host SED models used in this work. Derived by Alexa Gordon (Gordon et al 2023).
#### `james.c.w-p-z-dm`
Contains, as a set of numpy .npy files, the p(z|DM) distribution used in this work. Generated by Clancy James using the `zDM` code (https://github.com/FRBs/zdm; James et al 2021).
#### `imaging`
Contains imaging data used by this code; will be downloaded and extracted by [00-download](00-download.py)

### Scripts

#### `00_download.py`

Downloads and extracts the necessary input data.


#### `01_association.py`

Runs PATH (Probabilistic Association of Transients; Aggarwal et al 2021) in various configurations on the imaging data 
covering FRB 20210912A.


#### `02_association_analysis.py`

Derives results related to the PATH (Probabilistic Association of Transients; Aggarwal et al 2021) runs. 
Generates Figure 2.
Must be run AFTER `01_association.py`.


#### `03_imaging_limits.py`

Derives the imaging limits.


#### `04_redshift_hosts.py`

Generates the synthetic magnitudes for our FRB hosts at a range of redshifts.
Uses Prospector SED models generated by Gordon et al 2023.


#### `05_redshift_plots.py`

Generates Figures 3+.
`04_redshift_hosts.py` must be run first.


#### `06_foreground_halos.py`

Uses GAMA DR4 (Driver et al 2022) and mNFW profiles (Prochaska & Zheng 2019) to estimate a partial foreground halo 
contribution to the DM of FRB 20210912A.


#### `07_scattering.py`

Uses the framework of Cordes et al 2022 to estimate the host dispersion
measure contribution from the scattering timescale.


#### `08_bright_stars.py`

Finds the nuisance stars in Gaia and makes some check plots.


#### `09_frbstats.py`

Uses the FRBSTATS catalogue of FRBs (https://www.herta-experiment.org/frbstats/) to enumerate those that have DM 
consistent with z>1.


#### `10_misc_values.py`

Derives some miscellaneous values quoted in the paper, including DM_MW,ISM from YMW16 (Yao et al 2016)
and NE2001 (Cordes & Lazio 2002).


### References
 - Aggarwal, K. et al 2021: *Probabilistic Association of Transients to their Hosts (PATH)*, ApJ 95:911:2 [https://doi.org/10.3847/1538-4357/abe8d2]
 - Cordes, J. & Lazio T. 2002: *NE2001.I. A New Model for the Galactic Distribution of Free Electrons and its Fluctuations*, [http://arxiv.org/abs/astro-ph/0207156]
 - Cordes, J. et al 2022: *Redshift Estimation and Constraints on Intergalactic and Interstellar Media from Dispersion and Scattering of Fast Radio Bursts*, ApJ 931:2:88 [https://doi.org/10.3847/1538-4357/AC6873]
 - Driver, S. et al 2023: *Galaxy And Mass Assembly (GAMA): Data Release 4 and the z < 0.1 total and z < 0.08 morphological galaxy stellar mass functions*, MNRAS 513:1:439-467 [https://doi.org/10.1093/mnras/stac472]
 - Gordon, A. C. et al 2023: *The Demographics, Stellar Populations, and Star Formation Histories of Fast Radio Burst Host Galaxies: Implications for the Progenitors*, ApJ 954:1:80 [https://doi.org/10.3847/1538-4357/ace5aa]
 - James, C. W. et al 2021: *The zâ€“DM distribution of fast radio bursts*, MNRAS 509:4:4775-4802 [https://doi.org/10.1093/mnras/stab3051]
 - Marnoch, L. et al 2023: *The unseen host galaxy and high dispersion measure of a precisely-localised Fast Radio Burst suggests a high-redshift origin*, MNRAS 525:1:994-1007 [https://doi.org/10.1093/mnras/stad2353]
 - Prochaska, J. X. & Zheng, Y. 2019: *Probing Galactic haloes with fast radio bursts*, MNRAS 485:1:648-665 [https://doi.org/10.1093/mnras/stz261]
 - Spanakis-Misirlis, Apostolos & Van Eck, Cameron L.: *FRBSTATS: A web-based platform for visualization of fast radio burst properties*, The Open Journal of Astrophysics 6:7 [https://doi.org/10.21105/astro.2208.03508]
 - Yao, J. et al 2017: *A New Electron-density Model for Estimation of Pulsar and FRB Distances*, ApJ 835:1:29 [https://doi.org/10.3847/1538-4357/835/1/29]
